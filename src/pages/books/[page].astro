---
import type { Page } from 'astro';
import { getCollection, render } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import BookPreview from '@/components/BookPreview.astro';
import BaseLayout from '@/layouts/BaseLayout.astro';
import { slugify } from '@/utils/common-utils';

export async function getStaticPaths() {
    const books = (await getCollection('book')) as CollectionEntry<'book'>[];

    return books.map((book) => ({ params: { page: slugify(book.data.title) }, props: { book } }));
}

const { book } = Astro.props;
const { title } = book.data;
const { Content } = await render(book);
---

<BaseLayout title={title}>
    <BookPreview book={book} isLeafPage>
        <Content />
    </BookPreview>
</BaseLayout>
