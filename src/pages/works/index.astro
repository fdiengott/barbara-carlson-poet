---
import { getCollection } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import { slugify } from '@/utils/common-utils';
import { removeTemplates } from '@/utils/data-utils';
import WorkCard from '@/components/WorkCard.astro';

const works = await getCollection('book');
const cleanWorks = removeTemplates(works);
---

<BaseLayout title="Works" description="My works">
    <div class="title-wrapper">
        <h1>Works</h1>
    </div>
    <ul class="category-list">
        <ul class="works-list">
            {
                cleanWorks.map((work) => (
                    <li class="work-list-item">
                        <WorkCard {...work.data} slug={`/works/${slugify(work.data.title)}`} />
                    </li>
                ))
            }
        </ul>
    </ul>
</BaseLayout>

<style>
    .title-wrapper {
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        column-gap: var(--spacing-400);
        margin-block-end: var(--spacing-450);

        h1 {
            margin-block-end: 0;
        }
    }

    .category-pill-list {
        display: flex;
        gap: var(--spacing-200);
        flex-wrap: wrap;
    }

    .category-list {
        display: grid;
        gap: var(--spacing-500);
    }

    .category-title {
        text-transform: capitalize;
    }

    .work-list-item {
        margin-inline-start: var(--spacing-200);
    }

    .works-list {
        display: grid;
        gap: var(--spacing-300);
    }

    @media (min-width: 768px) {
        .works-list {
            gap: var(--spacing-500);
        }
    }
</style>
