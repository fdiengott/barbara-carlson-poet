---
import type { CollectionEntry } from 'astro:content';
import { Image } from 'astro:assets';
import { slugify } from '@/utils/common-utils';

interface Props {
    book: CollectionEntry<'book'>;
    imageDirection: 'left' | 'right';
}

const {
    book: {
        data: { title, publisher, year, image, url },
    },
    imageDirection = 'left',
} = Astro.props;
---

<article class="book-preview">
    <a href={`books/${slugify(title)}`} class:list={['book-link', { left: imageDirection === 'left' }, { right: imageDirection === 'right' }]} slot="image">
        <Image src={image.src} alt={image.alt} width={300} height={439} class="book-image" />
    </a>
    <div slot="text">
        <span class="title-wrapper">
            <h3 class="book-title">{title}</h3>
            <span class="purchase-link"><a href={url}>Purchase</a></span>
        </span>
        <p class="book-meta">{publisher && `${publisher}, `}{year}</p>
        <slot />
    </div>
</article>

<style>
    .book-link {
        display: grid;
        justify-content: center;
        margin-block-end: var(--spacing-200);
    }

    @container style(--inline-size-s: var(--breakpoint-sm)) {
        .book-link {
            --_cover-padding: var(--spacing-400);
            margin-block-end: 0;
        }

        .book-link.left {
            float: left;
            padding-inline-end: var(--_cover-padding);
            padding-block-end: var(--_cover-padding);
        }
        .book-link.right {
            float: right;
            padding-inline-start: var(--_cover-padding);
            padding-block-end: var(--_cover-padding);
        }
    }

    .book-title {
        font-size: var(--fs-500);
        font-weight: 500;
        margin: 0;
    }

    .book-meta {
        font-size: var(--fs-400);
        margin: 0;
    }

    .title-wrapper {
        display: flex;
        align-items: baseline;
        gap: var(--spacing-200);
    }

    .purchase-link {
        font-style: italic;
        font-size: var(--fs-300);
    }
</style>

<style is:global>
    .accreditation {
        margin-block-end: var(--spacing-400);
    }
</style>
